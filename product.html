<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Страница товара</title>
    <link rel="stylesheet" href="/css/header_and_footer.css">
    <link rel="stylesheet" href="/css/product_page.css">
    <!-- Подключение Materialize CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet">
    <style>
        .product-page {
            display: flex;
            justify-content: space-between;
            padding: 20px;
        }
        .thumbnails {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .product-image {
            position: relative;
            margin: 0 20px;
        }
        .product-image img {
            width: 100%;
            height: auto;
        }
        .overlay {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }
        .overlay img {
            max-width: 100%;
            max-height: 100%;
        }
        .product-info {
            width: 30%;
        }
        .related-products {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        .related-product img {
            width: 200px;
            height: 200px;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="wrapper">
            <div class="header_wrapper">
                <div class="header_logo"> 
                    <a href="/index.html" class="header_logo_link">
                        LOGO
                    </a>
                </div>
                <ul class="header_list">
                    <li class="header_item">
                        <a href="#!" class="header_link">НОВОСТИ</a>
                    </li>
                    <li class="header_item">
                        <a href="#!" class="header_link"> О НАС</a>
                    </li>
                    <li class="header_item">
                        <a href="#!" class="header_link">НОВИНКИ</a>
                    </li>
                    <li class="header_item">
                        <a href="#!" class="header_link">КОНТАКТЫ</a>
                    </li>
                    <li class="header_item">
                        <a href="/shoping_card.html" class="header_link">
                            <img src="./img/header/shopping_cart.svg" alt="" class="header_cart_pic">
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="product-page">
        <!-- Миниатюры изображений слева -->
        <div class="thumbnails" id="thumbnails"></div>

        <!-- Большое изображение товара по центру -->
        <div class="product-image">
            <img id="mainImage" src="" alt="Главное Изображение">
            <div class="overlay" id="overlayImage"></div>
        </div>

        <!-- Информация о товаре справа -->
        <div class="product-info">
            <h2 id="productName"></h2>
            <div class="price" id="productPrice"></div>
            <button class="add-to-cart" id="addToCart">Добавить в корзину</button>
            <div class="characteristics">
                <p><strong>Материал:</strong> <span id="productMaterial"></span></p>
                <p><strong>Цвет:</strong> <span id="productColor"></span></p>
                <p><strong>Размеры:</strong> <span id="productSize"></span></p>
            </div>
        </div>
    </div>

    <!-- 2 ряда по 3 картинки из раздела "С этим товаром покупают" -->
    <div>С этим товаром покупают</div>
    <div class="related-products" id="relatedProducts"></div>

    <script>
        function changeMainImage(thumbnail) {
            var overlay = document.getElementById('overlayImage');
            overlay.innerHTML = '<img src="' + thumbnail.src + '" alt="Overlay Image">';
            overlay.style.display = 'block';
        }

        function resetMainImage() {
            var overlay = document.getElementById('overlayImage');
            overlay.style.display = 'none';
        }

        // Функция для добавления товара в корзину
        function addToCart(product) {
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            let existingItem = cart.find(item => item.id === product.id);

            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ ...product, quantity: 1 });
            }

            localStorage.setItem('cart', JSON.stringify(cart));
            alert('Товар добавлен в корзину!');
        }

        // Функция для загрузки данных о товаре
        function loadProductData(productId) {
            fetch('/src/products.json')
                .then(response => response.json())
                .then(products => {
                    let product = products.find(p => p.id == productId);
                    if (product) {
                        document.getElementById('productName').textContent = product.name;
                        document.getElementById('productPrice').textContent = `$${product.price}`;
                        document.getElementById('productMaterial').textContent = product.material;
                        document.getElementById('productColor').textContent = product.color;
                        document.getElementById('productSize').textContent = product.size;
                        document.getElementById('mainImage').src = product.mainImage;

                        let thumbnails = document.getElementById('thumbnails');
                        thumbnails.innerHTML = '';
                        product.images.forEach(image => {
                            let img = document.createElement('img');
                            img.src = image;
                            img.alt = `Изображение ${product.images.indexOf(image) + 1}`;
                            img.onmouseover = () => changeMainImage(img);
                            img.onmouseout = resetMainImage;
                            thumbnails.appendChild(img);
                        });

                        let relatedProducts = document.getElementById('relatedProducts');
                        relatedProducts.innerHTML = '';
                        product.relatedProducts.forEach(relatedProduct => {
                            let div = document.createElement('div');
                            div.className = 'related-product';
                            let img = document.createElement('img');
                            img.src = relatedProduct.image;
                            img.alt = `Товар ${relatedProduct.id}`;
                            div.appendChild(img);
                            relatedProducts.appendChild(div);
                        });

                        document.getElementById('addToCart').onclick = () => addToCart(product);
                    } else {
                        alert('Товар не найден');
                    }
                })
                .catch(error => console.error('Ошибка загрузки данных:', error));
        }

        // Получаем ID товара из URL
        let urlParams = new URLSearchParams(window.location.search);
        let productId = urlParams.get('id');
        if (productId) {
            loadProductData(productId);
        } else {
            alert('Товар не выбран');
        }
    </script>
    <div class="footer">
        <div class="footer_nav">
            <ul class="footer_list">
                <li class="footer_item">
                    Пн-Вс 10:00-19:00
                </li>
                <li class="footer_item">
                    +(996)703-717-108
                </li>
            </ul>
            <ul class="footer_list">
                <li class="footer_item">
                    Мужчинам
                </li>
                <li class="footer_item">
                    Женщинам
                </li>
                <li class="footer_item">
                    Новинки
                </li>
            </ul>
            <ul class="footer_list">
                <li class="footer_item">
                    Оплата
                </li>
                <li class="footer_item">
                    Доставка
                </li>
            </ul>
            <ul class="footer_list_pic">
                <li class="footer_item_pic">
                    <img src="./img/footer/entypo-social_instagram-with-circle.png" alt="" class="header_cart_pic">
                </li>
                <li class="footer_item_pic">
                    <img src="./img/footer/entypo-social_vk-with-circle.png" alt="" class="header_cart_pic">
                </li>
                <li class="footer_item_pic">
                    <img src="./img/footer/entypo-social_twitter-with-circle.png" alt="" class="header_cart_pic">
                </li>
                <li class="footer_item_pic">
                    <img src="./img/footer/entypo-social_facebook-with-circle.png" alt="" class="header_cart_pic">
                </li>
                <li class="footer_item_pic">
                    <img src="./img/footer/entypo-social_youtube-with-circle.png" alt="">
                </li>
            </ul>
        </div>
    </div>
</body>
</html>